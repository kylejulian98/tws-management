buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:6.0.0'
    }
}

apply plugin: 'java'
apply plugin: 'java-library'
apply plugin: 'maven-publish'
apply plugin: 'com.github.johnrengelman.shadow'

shadowJar {
	archiveBaseName = 'TWSManagement'
	archiveClassifier = null
	archiveVersion = '1.0.0'
}

repositories {
    jcenter()

    maven { url 'https://papermc.io/repo/repository/maven-public/' }
  	maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
  	maven { url = 'https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core' }
  	maven { url = 'https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2' }
}

dependencies {
    api 'org.apache.commons:commons-math3:3.6.1'

    implementation 'com.google.guava:guava:28.0-jre'
    implementation 'com.fasterxml.jackson.core:jackson-core:2.10.3'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.10.3'
    implementation 'org.apache.commons:commons-dbcp2:2.7.0' // Connection Pooling
    
    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
    
    compileOnly files('lib/TABv2.8.4.jar')
    compileOnly 'net.luckperms:api:5.0'
    compileOnly 'org.jetbrains:annotations:19.0.0'
    compileOnly 'com.destroystokyo.paper:paper-api:1.16.2-R0.1-SNAPSHOT'
}

publishing {
    repositories {
        maven {
            name = 'GitHubPackages'
            url = uri('https://maven.pkg.github.com/kylejulian98/tws.management')
            credentials {
                username = project.findProperty('gpr.user') ?: System.getenv('USERNAME')
                password = project.findProperty('gpr.key') ?: System.getenv('TOKEN')
            }
        }
    }

    publications {
        shadow(MavenPublication) { publication ->
            groupId = 'dev.kylejulian.tws'
            artifactId = 'TWSManagement'
            version = '1.0.0'
            project.shadow.component(publication)
        }
    }
}