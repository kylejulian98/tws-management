plugins {
    id 'java-library'
    id 'com.github.johnrengelman.shadow' version '5.2.0'
	id 'maven-publish'
}

shadowJar {
	archiveBaseName = 'tws.management'
	archiveClassifier = null
	archiveVersion = '0.0.1'
}

repositories {
    jcenter()

    maven {
		name = 'MinecraftPackages'
        url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/'
        content {
			includeGroup 'org.bukkit'
			includeGroup 'org.spigotmc'
       }
    }
    
  	maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
  	maven { url = 'https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core' }
  	maven { url = 'https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2' }
  	 
  	mavenLocal() // This is needed for CraftBukkit and Spigot.
}

dependencies {
    api 'org.apache.commons:commons-math3:3.6.1'

    implementation 'com.google.guava:guava:28.0-jre'
    implementation 'com.fasterxml.jackson.core:jackson-core:2.10.3'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.10.3'
    implementation 'org.apache.commons:commons-dbcp2:2.7.0' // Connection Pooling
    
    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
    
    compileOnly files('lib/TABv2.8.1.jar')
    compileOnly 'net.luckperms:api:5.0'
    compileOnly 'org.jetbrains:annotations:19.0.0'

  	compileOnly 'org.spigotmc:spigot-api:1.16.1-R0.1-SNAPSHOT'
}

publishing {
    repositories {
        maven {
            name = 'GitHubPackages'
            url = uri('https://maven.pkg.github.com/kylejulian98/tws.management')
            credentials {
                username = project.findProperty('gpr.user') ?: System.getenv('USERNAME')
                password = project.findProperty('gpr.key') ?: System.getenv('TOKEN')
            }
        }
    }

    publications {
        shadow(MavenPublication) { publication ->
            groupId = 'dev.kylejulian.tws'
            artifactId = 'TWSManagement'
            version = '0.0.1'
            project.shadow.component(publication)
        }
    }
}